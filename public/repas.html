<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Les repas</title>
	</head>

	<body>
        
		<fieldset style="width:500px; height: 100px;">
			<legend>Affichage de Repas</legend>
			Renseignez date de repas : <input type="text" name="" id="name" placeholder="EX: 2022-04-23"/><br>
			Pour combien de personne : <input type="number" name="" id="nbr" /><br />
			
			<button>Ajouter</button>
		</fieldset>
		<fieldset>
			<legend>Liste des recettes</legend>
			<button id="voirRecettes">Voir les recettes</button>
			<div id="result"></div>
		</fieldset><br>
        <button><a href="http://localhost:3000/home.html">Revenir à l'accueil</a></button>

		<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
		<script>
			const button = document.querySelector("button");
			const buttonIngredients = document.querySelector("#voirRecettes");
			const nameInput = document.querySelector("#name");
			const nbrInput = document.querySelector("#nbr");
			

			button.addEventListener("click", () => {
				axios
					.post("/api/ingredients", {
						name: nameInput.value,
						nbr: nbrInput.value,
						poids: poidsInput.value,
					})
					.then((response) => {
						console.log(response.data);
					});
			});

            buttonIngredients.addEventListener("click", () => {
                   afficherIngredients();
                });

			function afficherIngredients() {
				const result = document.querySelector("#result");
				result.innerHTML = "";

				axios.get("/api/ingredients").then((response) => {
					console.log(response.data);

					response.data.forEach((element, index) => {
						const div = document.createElement("div");
						div.innerHTML = element.Nom +"          "+ element.nbr + " €";
						div.addEventListener("click", () => {
							axios.delete("/api/urls/" + index);
							updateIngredients();
						});
						result.appendChild(div);
					});
				});
			}
		</script>
	</body>
</html>
