<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Insérer de nouveaux ingrédients</title>
</head>

<body>
    <div id="result"></div>

    <fieldset>
        <legend>Ajouter un ingrédient</legend>
        Nom : <input type="text" name="" id="name" /><br />
        Prix : <input type="number" name="" id="prix" /><br />
        Poids : <input type="number" name="" id="poids" /><br />
        <button>Ajouter</button>
    </fieldset>
    <fieldset>
        <legend>Liste des ingrédients renseignés</legend>
        updateIngredients();
    </fieldset>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        const button = document.querySelector("button");
        const nameInput = document.querySelector("#name");
        const prixInput = document.querySelector("#prix");
        const poidsInput = document.querySelector("#poids");

        button.addEventListener("click", () => {
            axios
                .post("/api/ingredients", {
                    name: nameInput.value,
                    prix: prixInput.value,
                    poids: poidsInput.value,
                })
                .then((response) => {
                    console.log(response.data);
                });
        });

        function updateIngredients() {
            const result = document.querySelector("#result");
            result.innerHTML = "";

            axios.get("/api/ingredients").then((response) => {
                console.log(response.data);

                response.data.forEach((element, index) => {
                    const div = document.createElement("div");
                    div.innerHTML = element.name;
                    div.addEventListener('click', () => {
                        axios.delete('/api/urls/' + index)
                        updateIngredients()
                    })
                    result.appendChild(div)
                });
            });
        }
    </script>
</body>

</html>